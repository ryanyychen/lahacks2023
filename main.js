var courseListL = {
    "CSE 3": [],
    "CSE 4GS": [
        [
            "MATH 10A",
            "MATH 20A"
        ]
    ],
    "CSE 6GS": [
        [
            "MATH 10A",
            "MATH 20A"
        ]
    ],
    "CSE 6R": [],
    "CSE 8A": [],
    "CSE 8B": [
        [
            "CSE 8A"
        ]
    ],
    "CSE 11": [],
    "CSE 12": [
        [
            "CSE 8B",
            "CSE 11"
        ]
    ],
    "CSE 15L": [
        [
            "CSE 8B",
            "CSE 11",
            "CSE 12",
            "DSC 30"
        ]
    ],
    "CSE 20": [
        [
            "CSE 11",
            "CSE 6R",
            "CSE 8A",
            "CSE 8B",
            "ECE 15"
        ]
    ],
    "CSE 21": [
        [
            "CSE 20",
            "MATH 15A",
            "MATH 31CH"
        ]
    ],
    "CSE 30": [
        [
            "CSE 12"
        ],
        [
            "CSE 15L"
        ]
    ],
    "CSE 42": [],
    "CSE 86": [
        [
            "CSE 12"
        ]
    ],
    "CSE 87": [],
    "CSE 90": [],
    "CSE 91": [],
    "CSE 95": [],
    "CSE 99": []
};

var courseListU = {
    "CSE 100": [
        [
            "CSE 21",
            "MATH 154",
            "MATH 158",
            "MATH 184",
            "MATH 188"
        ],
        [
            "CSE 12"
        ],
        [
            "CSE 15L"
        ],
        [
            "CSE 30",
            "ECE 15"
        ]
    ],
    "CSE 100R": [
        [
            "CSE 21",
            "MATH 154",
            "MATH 158",
            "MATH 184",
            "MATH 188"
        ],
        [
            "CSE 12"
        ],
        [
            "CSE 15L"
        ],
        [
            "CSE 30",
            "ECE 15"
        ]
    ],
    "CSE 101": [
        [
            "CSE 21",
            "MATH 154",
            "MATH 158",
            "MATH 184",
            "MATH 188"
        ],
        [
            "CSE 12",
            "DSC 30"
        ]
    ],
    "CSE 103": [
        [
            "MATH 20B"
        ],
        [
            "CSE 21",
            "MATH 154",
            "MATH 158",
            "MATH 184",
            "MATH 188"
        ]
    ],
    "CSE 105": [
        [
            "CSE 12"
        ],
        [
            "CSE 15L"
        ],
        [
            "CSE 20",
            "MATH 109",
            "MATH 15A",
            "MATH 31CH"
        ],
        [
            "CSE 21",
            "MATH 100A",
            "MATH 103A",
            "MATH 154",
            "MATH 158",
            "MATH 184",
            "MATH 188"
        ]
    ],
    "CSE 106": [
        [
            "MATH 18",
            "MATH 31AH"
        ],
        [
            "MATH 20C",
            "MATH 31BH"
        ],
        [
            "CSE 21",
            "DSC 40B",
            "MATH 154",
            "MATH 158",
            "MATH 184",
            "MATH 188"
        ]
    ],
    "CSE 107": [
        [
            "CSE 21",
            "MATH 154",
            "MATH 158",
            "MATH 184",
            "MATH 188"
        ],
        [
            "CSE 101"
        ],
        [
            "CSE 105"
        ]
    ],
    "CSE 109": [
        [
            "CSE 30",
            "permission of instructor"
        ]
    ],
    "CSE 110": [
        [
            "CSE 100",
            "CSE 100R"
        ]
    ],
    "CSE 112": [
        [
            "CSE 110"
        ]
    ],
    "CSE 118": [
        [
            "any course from the following: CSE 131, CSE 132B, COGS 102C, COGS 121, COGS 184, COMT 111B, COMT 115, ECE 111, ECE 118, ECE 191, ECE 192,",
            "ICAM 160B"
        ]
    ],
    "CSE 120": [
        [
            "CSE 30"
        ],
        [
            "CSE 101"
        ],
        [
            "CSE 110"
        ]
    ],
    "CSE 123": [
        [
            "CSE 30"
        ],
        [
            "CSE 101"
        ],
        [
            "CSE 110"
        ]
    ],
    "CSE 124": [
        [
            "CSE 30"
        ],
        [
            "CSE 101"
        ],
        [
            "CSE 110"
        ]
    ],
    "CSE 125": [],
    "CSE 127": [
        [
            "CSE 21",
            "MATH 154",
            "MATH 158",
            "MATH 184",
            "MATH 188"
        ],
        [
            "CSE 120",
            "CSE 123",
            "CSE 124"
        ]
    ],
    "CSE 130": [
        [
            "CSE 12"
        ],
        [
            "CSE 100",
            "CSE 100R"
        ],
        [
            "CSE 105"
        ]
    ],
    "CSE 131": [
        [
            "CSE 100",
            "CSE 100R"
        ],
        [
            "CSE 105"
        ],
        [
            "CSE 130"
        ]
    ],
    "CSE 132A": [
        [
            "CSE 100",
            "CSE 100R"
        ]
    ],
    "CSE 132B": [
        [
            "CSE 132A"
        ]
    ],
    "CSE 132C": [
        [
            "CSE 132A",
            "DSC 102"
        ]
    ],
    "CSE 134B": [
        [
            "CSE 100",
            "CSE 100R"
        ]
    ],
    "CSE 135": [
        [
            "CSE 100",
            "CSE 100R"
        ]
    ],
    "CSE 136": [
        [
            "CSE 135"
        ]
    ],
    "CSE 140": [
        [
            "CSE 20",
            "MATH 109",
            "MATH 15A",
            "MATH 31CH"
        ],
        [
            "CSE 30"
        ]
    ],
    "CSE 140L": [
        [
            "CSE 20",
            "MATH 109",
            "MATH 15A",
            "MATH 31CH"
        ],
        [
            "CSE 30"
        ]
    ],
    "CSE 141": [
        [
            "CSE 30"
        ],
        [
            "CSE 140"
        ],
        [
            "CSE 140L"
        ]
    ],
    "CSE 141L": [
        [
            "CSE 30"
        ],
        [
            "CSE 140"
        ],
        [
            "CSE 140L"
        ]
    ],
    "CSE 142": [
        [
            "CSE 30"
        ],
        [
            "CSE 100",
            "CSE 100R"
        ]
    ],
    "CSE 142L": [
        [
            "CSE 30"
        ],
        [
            "CSE 100",
            "CSE 100R"
        ]
    ],
    "CSE 143": [
        [
            "CSE 140"
        ]
    ],
    "CSE 145": [],
    "CSE 148": [
        [
            "CSE 141"
        ],
        [
            "CSE 141L"
        ]
    ],
    "CSE 150A": [
        [
            "CSE 12",
            "DSC 40B"
        ],
        [
            "CSE 15L",
            "DSC 80"
        ],
        [
            "COGS 118D",
            "CSE 103",
            "ECE 109",
            "ECON 120A",
            "MATH 180A",
            "MATH 183"
        ],
        [
            "MATH 20A"
        ],
        [
            "MATH 18",
            "MATH 31AH"
        ]
    ],
    "CSE 150B": [
        [
            "CSE 12",
            "DSC 40B"
        ],
        [
            "CSE 15L",
            "DSC 80"
        ],
        [
            "COGS 118D",
            "CSE 103",
            "ECE 109",
            "ECON 120A",
            "MATH 180A",
            "MATH 183"
        ],
        [
            "CSE 100",
            "CSE 100R"
        ]
    ],
    "CSE 151A": [
        [
            "CSE 12",
            "DSC 40B"
        ],
        [
            "CSE 15L",
            "DSC 80"
        ],
        [
            "COGS 118D",
            "CSE 103",
            "ECE 109",
            "ECON 120A",
            "MATH 181A",
            "MATH 183"
        ],
        [
            "MATH 18",
            "MATH 31AH"
        ],
        [
            "MATH 20C",
            "MATH 31BH"
        ]
    ],
    "CSE 151B": [
        [
            "MATH 20C",
            "MATH 31BH"
        ],
        [
            "BENG 134",
            "COGS 118D",
            "CSE 103",
            "ECE 109",
            "ECON 120A",
            "MAE 108",
            "MATH 181A",
            "MATH 183",
            "MATH 186"
        ]
    ],
    "CSE 152A": [
        [
            "MATH 18",
            "MATH 31AH"
        ],
        [
            "CSE 12",
            "DSC 30"
        ],
        [
            "CSE 15L",
            "DSC 80"
        ]
    ],
    "CSE 152B": [
        [
            "CSE 152A",
            "CSE 152",
            "CSE 166"
        ]
    ],
    "CSE 156": [
        [
            "CSE 12",
            "DSC 40B"
        ],
        [
            "CSE 15L",
            "DSC 80"
        ],
        [
            "BENG 134",
            "COGS 118D",
            "CSE 103",
            "ECE 109",
            "ECON 120A",
            "MATH 180A",
            "MATH 181A",
            "MATH 183",
            "MATH 186"
        ]
    ],
    "CSE 158": [
        [
            "CSE 12",
            "DSC 40B"
        ],
        [
            "CSE 15L",
            "DSC 80"
        ],
        [
            "BENG 100",
            "BENG 134",
            "COGS 118D",
            "CSE 103",
            "ECE 109",
            "ECON 120A",
            "MATH 180A",
            "MATH 181A",
            "MATH 183",
            "MATH 186"
        ]
    ],
    "CSE 158R": [
        [
            "CSE 12",
            "DSC 40B"
        ],
        [
            "CSE 15L",
            "DSC 80"
        ],
        [
            "BENG 100",
            "BENG 134",
            "COGS 118D",
            "CSE 103",
            "ECE 109",
            "ECON 120A",
            "MATH 180A",
            "MATH 181A",
            "MATH 183",
            "MATH 186"
        ]
    ],
    "CSE 160": [
        [
            "CSE 100",
            "CSE 100R"
        ]
    ],
    "CSE 163": [
        [
            "CSE 167"
        ]
    ],
    "CSE 165": [
        [
            "CSE 167"
        ]
    ],
    "CSE 166": [
        [
            "DSC 40B",
            "MATH 18",
            "MATH 31AH"
        ],
        [
            "CSE 100",
            "CSE 100R",
            "DSC 80"
        ]
    ],
    "CSE 167": [
        [
            "CSE 100",
            "CSE 100R"
        ]
    ],
    "CSE 168": [
        [
            "CSE 167"
        ]
    ],
    "CSE 169": [
        [
            "CSE 167"
        ]
    ],
    "CSE 170": [
        [
            "COGS 108",
            "CSE 12",
            "DSC 30"
        ],
        [
            "COGS 1",
            "COGS 10",
            "DSGN 1",
            "ENG 100D"
        ]
    ],
    "CSE 175": [],
    "CSE 176A": [
        [
            "CSE 110",
            "CSE 170",
            "COGS 120"
        ]
    ],
    "CSE 176E": [],
    "CSE 180": [
        [
            "BILD 1"
        ]
    ],
    "CSE 180R": [
        [
            "BILD 1",
            "BILD 4",
            "CSE 3",
            "CSE 7",
            "CSE 8A",
            "CSE 8B",
            "CSE 11"
        ]
    ],
    "CSE 181": [
        [
            "CSE 100",
            "CSE 100R\u00a0and CSE 101"
        ],
        [
            "BIMM 100",
            "CHEM 114C"
        ]
    ],
    "CSE 182": [
        [
            "CSE 100",
            "CSE 100R"
        ]
    ],
    "CSE 184": [
        [
            "BIMM 181",
            "BENG 181",
            "CSE 181, BENG 182",
            "BIMM 182",
            "CSE 182",
            "CHEM 182"
        ]
    ],
    "CSE 185": [
        [
            "CSE 11",
            "CSE 8B"
        ],
        [
            "CSE 12"
        ],
        [
            "MATH 20C",
            "MATH 31BH"
        ],
        [
            "BILD 1"
        ],
        [
            "BIEB 123",
            "BILD 4",
            "BIMM 101",
            "CHEM 109"
        ]
    ],
    "CSE 190": [],
    "CSE 191": [],
    "CSE 192": [],
    "CSE 193": [],
    "CSE 194": [
        [
            "AAS 10",
            "CSE 12",
            "ECE 35",
            "ETHN 3",
            "HILD 7A",
            "LTEN 27"
        ],
        [
            "CAT 125",
            "CAT 125R",
            "CAT 3",
            "DOC 3",
            "HUM 2",
            "MCWP 125",
            "MCWP 125R",
            "MCWP 50",
            "MCWP 50R",
            "MMW 121",
            "MMW 121R",
            "MMW 122",
            "MMW 13",
            "SYN 2",
            "WCWP 100",
            "WCWP 10B"
        ]
    ],
    "CSE 195": [],
    "CSE 197": [],
    "CSE 197C": [],
    "CSE 198": [],
    "CSE 199": [],
    "CSE 199H": []
};

var completed = [];
var layerNum = 1;
var courses = Object.keys(courseListL).concat(Object.keys(courseListU));

/* Run while requirements for degree not completed */
while (layerNum < 40) {
    let fullList = true;
    for (let i = 0; i < completed.length; i++) {
        if (!completed.includes(courses[i])) {
            fullList = false;
        }
    }
    if (completed.length != courses.length) fullList = false;
    if (fullList) break;

    /* Add new layer to tree */
    addLayer(layerNum, document.getElementById("tree_display"));

    let taking = [];

    /* Iterate map to find classes that can be taken
      and create nodes of those classes */
    for (var course of courses) {
    /* If node of course does not already exist then check for prerequisites
         then create new node if all prereqs satisfied*/
    if (!completed.includes(course)) {
        /* Get array of prerequisites using key */
        let allPrerequisites;
        if (Object.keys(courseListL).includes(course)) {
            allPrerequisites = courseListL[course];
        } else {
            allPrerequisites = courseListU[course];
        }
         

         // For now use first element in each 'and' list
         let prerequisites = [];
         for (let i = 0; i < allPrerequisites.length; i++) {
            prerequisites.push(allPrerequisites[i][0])
         }

         let canTake = true;
         let prereqs = [];
         /* Iterate through each prerequisite and check if in 'completed' array */
         if (prerequisites.length > 0 && prerequisites[0] !== null) {
            for (let i = 0; i < prerequisites.length; i++) {
               prereqs.push(prerequisites[i]);
               if (!completed.includes(prerequisites[i])) {
                  canTake = false;
               }
            }
         }
         /* If all prereqs satisfied, create new node and add to layer */
         if (canTake) {
            if ((Object.keys(courseListU).includes(course) && courseListU[course].length == 0)
                || (Object.keys(courseListU).includes(course) && layerNum < 4)) {
                continue;
            } else {
                addCourse(course, document.getElementById("layer" + layerNum), prereqs);
            }

            /* Add course to list of courses in this layer */
            taking.push(course);
         }
      }
   }
   /* Add all courses in this layer to completed courses */
   for (let i = 0; i < taking.length; i++) {
      completed.push(taking[i]);
   }
   layerNum++;
}

/* Function to create new layer and append to tree_display div */
function addLayer(layerNum, parentDiv) {
   let layer = document.createElement('div');
   layer.className = "tree_layer";
   layer.id = "layer" + layerNum;
   parentDiv.appendChild(layer);
}

/* Function to create new course and append to layer */
function addCourse(courseName, parentDiv, prereqs) {
   let node = document.createElement('div');
   node.className = "node";
   node.id = courseName;
   let course = document.createElement('span');
   course.className = "course";
   course.textContent = courseName;
   node.dataset.prerequisites = prereqs;
   node.appendChild(course);
   parentDiv.appendChild(node);
}